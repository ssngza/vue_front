{"remainingRequest":"C:\\Users\\tmdgu\\vue_front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\tmdgu\\vue_front\\src\\components\\hr\\salary\\salaryAwards.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\tmdgu\\vue_front\\src\\components\\hr\\salary\\salaryAwards.vue","mtime":1683620245304},{"path":"C:\\Users\\tmdgu\\vue_front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1683631553846},{"path":"C:\\Users\\tmdgu\\vue_front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1683631584615},{"path":"C:\\Users\\tmdgu\\vue_front\\node_modules\\postcss-loader\\src\\index.js","mtime":1683631572251},{"path":"C:\\Users\\tmdgu\\vue_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682425602778},{"path":"C:\\Users\\tmdgu\\vue_front\\node_modules\\vue-loader\\lib\\index.js","mtime":1683631584611}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5tb2RhbC1kaWFsb2cyIHsNCiAgICAgLyog66qo64usIOywveydhCDsmbzsqr3snLzroZwg7JyE7LmYICovDQogICAgbWF4LXdpZHRoOiA4MCU7IC8qIOuqqOuLrCDssL3snZgg7LWc64yAIOqwgOuhnCDrhIjruYTrpbwgMTAwJeuhnCDshKTsoJUgKi8NCiAgICB3aWR0aDogMTAwJTsgLyog66qo64usIOywveydmCDqsIDroZwg64SI67mE66W8IDEwMCXroZwg7ISk7KCVICovDQp9DQoNCg=="},{"version":3,"sources":["salaryAwards.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8fA;AACA;AACA;AACA;AACA","file":"salaryAwards.vue","sourceRoot":"src/components/hr/salary","sourcesContent":["<template>\r\n    <div>\r\n\r\n        <b-row>\r\n            <b-col\r\n                    md=\"2\"\r\n                    sm=\"4\"\r\n                    class=\"my-1\"\r\n            >\r\n                <b-form-group\r\n                        class=\"mb-0\"\r\n                >\r\n                    <label class=\"d-inline-block text-sm-left mr-50\">페이지 수</label>\r\n                    <b-form-select\r\n                            idnp=\"perPageSelect\"\r\n                            v-model=\"perPage\"\r\n                            size=\"sm\"\r\n                            :options=\"pageOptions\"\r\n                            class=\"w-50\"\r\n                    />\r\n                </b-form-group>\r\n            </b-col>\r\n            <b-col\r\n                    md=\"4\"\r\n                    sm=\"8\"\r\n                    class=\"my-1\"\r\n            >\r\n                <b-form-group\r\n                        label=\"정렬\"\r\n                        label-cols-sm=\"3\"\r\n                        label-align-sm=\"right\"\r\n                        label-size=\"sm\"\r\n                        label-for=\"sortBySelect\"\r\n                        class=\"mb-0\"\r\n                >\r\n                    <b-input-group size=\"sm\">\r\n                        <b-form-select\r\n                                id=\"sortBySelect\"\r\n                                v-model=\"sortBy\"\r\n                                :options=\"sortOptions\"\r\n                                class=\"w-75\"\r\n                        >\r\n                            <template v-slot:first>\r\n                                <option value=\"\">\r\n                                    -- none --\r\n                                </option>\r\n                            </template>\r\n                        </b-form-select>\r\n                        <b-form-select\r\n                                v-model=\"sortDesc\"\r\n                                size=\"sm\"\r\n                                :disabled=\"!sortBy\"\r\n                                class=\"w-25\"\r\n                        >\r\n                            <option :value=\"false\">\r\n                                Asc\r\n                            </option>\r\n                            <option :value=\"true\">\r\n                                Desc\r\n                            </option>\r\n                        </b-form-select>\r\n                    </b-input-group>\r\n                </b-form-group>\r\n            </b-col>\r\n            <b-col\r\n                    md=\"5\"\r\n                    class=\"my-1\"\r\n            >\r\n                <b-form-group\r\n                        label=\"전체 검색\"\r\n                        label-cols-sm=\"3\"\r\n                        label-align-sm=\"right\"\r\n                        label-size=\"sm\"\r\n                        label-for=\"filterInput\"\r\n                        class=\"mb-0\"\r\n                >\r\n                    <b-input-group size=\"sm\">\r\n                        <b-form-input\r\n                                id=\"filterInput\"\r\n                                v-model=\"filter\"\r\n                                type=\"search\"\r\n                                placeholder=\"검색어\"\r\n                        />\r\n                        <b-input-group-append>\r\n                            <b-button\r\n                                    :disabled=\"!filter\"\r\n                                    @click=\"filter = ''\"\r\n                            >\r\n                                Clear\r\n                            </b-button >\r\n                            <b-button @click=\"openInsert\">추가</b-button>\r\n                        </b-input-group-append>\r\n\r\n                    </b-input-group>\r\n\r\n                </b-form-group>\r\n\r\n            </b-col>\r\n                <!-- 성과금 추가 인원  모달--->\r\n            <b-modal v-model=\"insertModal\">\r\n            <b-form>\r\n                <b-row>\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label=\"부서코드\"\r\n                        >\r\n                            <b-form-select\r\n                                id=\"deptCode\"\r\n                                v-model=\"addBonusEmp.empCode\"\r\n                            />\r\n                        </b-form-group>\r\n                    </b-col>\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label=\"사원코드\"\r\n                        >\r\n                            <b-form-input\r\n                                id=\"empCode\"\r\n                                v-model=\"addBonusEmp.empCode\"\r\n                            />\r\n                        </b-form-group>\r\n                    </b-col>\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label=\"사원이름\"\r\n                        >\r\n                            <b-form-input\r\n                                id=\"empName\"\r\n                                v-model=\"addBonusEmp.empName\"\r\n                            />\r\n                        </b-form-group>\r\n                    </b-col>\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label-for=\"reportingDate\"\r\n                            label=\"지급년월\"\r\n                        >\r\n                            <b-form-input\r\n                                id=\"applyYearMonth\"\r\n                                v-model=\"addBonusEmp.applyYearMonth\"\r\n                                type=\"date\"\r\n                            />\r\n                        </b-form-group>\r\n                    </b-col>\r\n\r\n\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label=\"성과금이름\"\r\n                        >\r\n                            <b-form-input\r\n                                id=\"bonusName\"\r\n                                v-model=\"addBonusEmp.bonusName\"\r\n                            />\r\n                        </b-form-group>\r\n                    </b-col>\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label=\"성과금 정보\"\r\n                        >\r\n                            <b-form-input\r\n                                id=\"bonusRemark\"\r\n                                v-model=\"addBonusEmp.bonusRemark\"\r\n                            />\r\n                        </b-form-group>\r\n                    </b-col>\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label=\"성과금\"\r\n                        >\r\n                                <b-form-input\r\n                                    id=\"bonus\"\r\n                                    v-model=\"addBonusEmp.bonus\"\r\n                                />\r\n                        </b-form-group>\r\n                    </b-col>\r\n\r\n                    <b-col md=\"6\">\r\n                        <b-form-group\r\n                            label=\"공제액\"\r\n                        >\r\n                            <b-form-input\r\n                                id=\"deductionAmount\"\r\n                                v-model=\"addBonusEmp.deductionAmount\"\r\n                            />\r\n                        </b-form-group>\r\n                    </b-col>\r\n                    <!-- submit and reset -->\r\n                    <b-col>\r\n                        <b-button\r\n                            type=\"reset\"\r\n                            variant=\"outline-secondary\"\r\n                        >\r\n                            Reset\r\n                        </b-button>\r\n                    </b-col>\r\n                </b-row>\r\n                </b-form>\r\n            </b-modal>\r\n\r\n            <transition class=\"start\">\r\n                <b-col cols=\"16 \">\r\n                    <b-table\r\n                        style=\"width: 130%;\"\r\n                            striped\r\n                            hover\r\n                            responsive=\"true\"\r\n                            :per-page=\"perPage\"\r\n                            :current-page=\"currentPage\"\r\n                            :items=\"formattedEmpBonus\"\r\n                            :fields=\"fields\"\r\n                            :sort-by.sync=\"sortBy\"\r\n                            :sort-desc.sync=\"sortDesc\"\r\n                            :sort-direction=\"sortDirection\"\r\n                            :filter=\"filter\"\r\n                            :filter-included-fields=\"filterOn\"\r\n                            @filtered=\"onFiltered\"\r\n                            @row-clicked=\"onRowSelected\"\r\n                    >\r\n                    </b-table>\r\n                    <!--    row 클릭시 수정창 띄우는 모달-->\r\n                    <b-modal v-model=\"showModal\" @ok=\"showModal2\"  @cancel=\"resetData\" dialog-class=\"modal-dialog2\">\r\n                        <h1 class=\"text-center\">상여 및 성과금 수정</h1>\r\n                        <b-table\r\n                            ref=\"modalTable\"\r\n                            striped\r\n                            hover\r\n                            :items=\"this.selectedRow\"\r\n                            :fields=\"fields\"\r\n                            @row-clicked=\"updateBonus\"\r\n                            >\r\n                        </b-table>\r\n                        <!--   한번 더 확인하는 모달-->\r\n                    </b-modal>\r\n                    <b-modal v-model=\"showConfirmModal\" @ok=\"confirmAction\"   dialog-class=\"custom-modal-class\">\r\n                        <h1 class=\"text-center\">수정하시겠습니까?</h1>\r\n                    </b-modal>\r\n\r\n                </b-col>\r\n            </transition>\r\n\r\n\r\n            <b-col\r\n                    cols=\"12\"\r\n            >\r\n                <b-pagination\r\n                        v-model=\"currentPage\"\r\n                        :total-rows=\"totalRows\"\r\n                        :per-page=\"perPage\"\r\n                        align=\"center\"\r\n                        size=\"sm\"\r\n                        class=\"my-0\"\r\n                />\r\n            </b-col>\r\n        </b-row>\r\n\r\n        <!--    <b-table striped hover :items=\"items\"></b-table>-->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n    BAvatar,\r\n    BBadge,\r\n    BButton,\r\n    BCard,\r\n    BCardText,\r\n    BCol,\r\n    BFormGroup,\r\n    BFormInput,\r\n    BFormSelect,\r\n    BInputGroup,\r\n    BInputGroupAppend,\r\n    BLink,\r\n    BPagination,\r\n    BRow,\r\n    BTable\r\n} from 'bootstrap-vue'\r\n\r\nimport {mapState,mapActions} from \"vuex\";\r\nimport {replace} from \"lodash\";\r\n\r\n\r\n\r\nexport default {\r\n    name: \"salaryAwards\",\r\n    components: {\r\n        BTable,\r\n        BAvatar,\r\n        BBadge,\r\n        BRow,\r\n        BCol,\r\n        BFormGroup,\r\n        BFormSelect,\r\n        BPagination,\r\n        BInputGroup,\r\n        BFormInput,\r\n        BInputGroupAppend,\r\n        BButton,\r\n        BCard,\r\n        BLink,\r\n        BCardText,\r\n    },\r\n\r\n    // and in data\r\n    data() {\r\n        return {\r\n            hideHow: true,\r\n            perPage: 5,\r\n            pageOptions: [3, 5, 10],\r\n            currentPage: 1,\r\n            sortBy: '',\r\n            sortDesc: false,\r\n            sortDirection: 'asc',\r\n            filter: null,\r\n            filterOn: [],\r\n            totalRows: 0,\r\n            selectedRow: [],\r\n            showModal: false,\r\n            editingRowId: null,\r\n            changeData:[],\r\n            showConfirmModal: false, // 확인창의 v-model,\r\n            formattedEmpBonus: [], // 변환된 데이터\r\n            reset:[],\r\n            insertModal:false,\r\n\r\n            addBonusEmp: [{\r\n                empCode: '',\r\n                applyYearMonth:'',\r\n                bonusName: '',\r\n                bonusRemark: '',\r\n                bonus: '',\r\n                deductionAmount: '',\r\n            }],\r\n\r\n\r\n\r\n            fields: [\r\n                {key: 'empCode', label: '사원코드', sortable: true},\r\n                {key: 'empName', label: '사원이름', sortable: true},\r\n                {key: 'deptCode', label: '부서코드', sortable: true},\r\n                {key: 'applyYearMonth', label: '지급년월', sortable: true},\r\n                {key: 'bonusName', label: '성과금이름', sortable: true},\r\n                {key: 'bonusRemark', label: '성과금정보', sortable: true},\r\n                {key: 'bonus', label: '금액', sortable: true},\r\n                {key: 'deductionAmount', label: '공제액', sortable: true},\r\n            ],\r\n\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapState('hr/salary', ['empBonus']),\r\n        sortOptions() {\r\n            // Create an options list from our fields\r\n            return this.fields\r\n                .filter(f => f.sortable)\r\n                .map(f => ({text: f.label, value: f.key}))\r\n        },\r\n\r\n    },\r\n\r\n\r\n\r\n    created() {\r\n        this.fetch_bonus_emp_list();\r\n        setTimeout(() => { this.formatEmpBonus(); }, 200)\r\n    },\r\n\r\n    mounted() {\r\n        setTimeout(() => {\r\n            this.totalRows = this.empBonus.length;\r\n        }, 200)\r\n    },\r\n\r\n    methods: {\r\n        ...mapActions('hr/salary', ['fetch_bonus_emp_list',\"set_bonus\"]),\r\n\r\n        onRowSelected(items) {\r\n\r\n            this.selectedRow = [items]\r\n            this.showModal = true;\r\n            this.fetch_bonus_emp_list();\r\n\r\n        },\r\n        resetData(){\r\n             this.formatEmpBonus()\r\n        },\r\n        openInsert(){\r\n            this.insertModal=true;\r\n        }\r\n        ,\r\n\r\n\r\n        updateBonus(item, index, event) {\r\n            // 행 클릭 시 실행될 메서드\r\n            // item: 클릭한 행의 데이터 객체\r\n            // index: 클릭한 행의 인덱스\r\n            // event: 클릭 이벤트 객체\r\n\r\n\r\n            // 이미 수정 중인 행이 있는 경우 무시\r\n            if (this.editingRowId !== null) {\r\n                return;\r\n            }\r\n\r\n            // 클릭한 행의 데이터를 수정하기 위한 input 요소 생성\r\n            const inputElement = document.createElement(\"input\");\r\n            const tdElement = event.target.closest(\"td\");\r\n            if(tdElement.getAttribute(\"aria-colindex\")==null){\r\n                alert('제대로 클릭해주세요')\r\n                return;\r\n            }\r\n            const index2 = tdElement.getAttribute(\"aria-colindex\")-1;\r\n\r\n\r\n            const column = this.fields[index2].key\r\n            inputElement.value = tdElement.textContent.trim(); // 예시로 name 필드를 수정하도록 설정\r\n            inputElement.addEventListener(\"blur\", event => {\r\n                // input 요소에서 포커스가 벗어났을 때(수정이 완료되었을 때) 실행될 로직\r\n                this.onInputBlur(item, event.target.value,column);\r\n            });\r\n\r\n            // 클릭한 행의 데이터를 표시한 뒤 input 요소로 교체\r\n\r\n            if(index2>2){\r\n                tdElement.textContent = \"\";\r\n                tdElement.appendChild(inputElement);\r\n                console.log(column)\r\n                inputElement.focus();\r\n                this.editingRowId = tdElement.textContent.trim();\r\n            }\r\n\r\n           // 수정 중인 행의 ID 저장\r\n\r\n        },\r\n        onInputBlur(item, newValue,column) {\r\n            // input 요소에서 포커스가 벗어났을 때(수정이 완료되었을 때) 실행될 메서드\r\n            // item: 수정 중인 행의 데이터 객체\r\n            // newValue: 수정된 값\r\n            // 여기에 수정된 데이터 처리 로직을 구현\r\n\r\n            // 특정 메서드 호출 등의 로직을 작성\r\n            const tdElement = event.target.closest(\"td\");\r\n            tdElement.textContent = newValue;\r\n            this.selectedRow[0][column]=newValue;\r\n            console.log(\"selectedRow\",this.selectedRow)\r\n            // 수정이 완료되었으므\r\n            // 로 input 요소를 다시 텍스트로 교체\r\n\r\n            this.editingRowId = null; // 수정 중인 행의 ID 초기화\r\n        },\r\n        showModal2(event){\r\n            event.preventDefault();\r\n            this.showConfirmModal = true;\r\n        },\r\n\r\n        confirmAction() {\r\n            this.showConfirmModal = false;\r\n            this.showModal=false;\r\n            // ,떼서 백단으로 보내기\r\n            let bonusWithoutComma = this.selectedRow[0].bonus.replace(/,/g, ''); //콤마떼기\r\n            let deductionAmountWithoutComma = this.selectedRow[0].deductionAmount.replace(/,/g, '');\r\n\r\n            // 제거된 값으로 데이터 업데이트\r\n            this.selectedRow[0].bonus = bonusWithoutComma;\r\n            this.selectedRow[0].deductionAmount = deductionAmountWithoutComma;\r\n\r\n            console.log(\"dddd\",this.selectedRow[0].bonus,this.selectedRow[0].applyYearMonth)\r\n             this.set_bonus(this.selectedRow[0]);\r\n\r\n            setTimeout(() => { this.fetch_bonus_emp_list(); }, 300)\r\n            setTimeout(() => { this.formatEmpBonus(); }, 400)\r\n\r\n\r\n        },\r\n        // 금액에 , 붙이기 메서드\r\n        formatEmpBonus() {\r\n            this.formattedEmpBonus = this.empBonus.map(item => {\r\n                return {\r\n                    ...item,\r\n                    bonus: item.bonus.toLocaleString(), // 숫자에 쉼표 추가\r\n                    deductionAmount: item.deductionAmount.toLocaleString(), // 숫자에 쉼표 추가\r\n                };\r\n            });\r\n        },\r\n\r\n        //필터용\r\n        onFiltered(filteredItems) {\r\n            // Trigger pagination to update the number of buttons/pages due to filtering\r\n            this.totalRows = filteredItems.length\r\n            console.log(this.totalRows + \"filter\")\r\n            this.currentPage = 1\r\n        },\r\n\r\n\r\n\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n\r\n<style>\r\n.modal-dialog2 {\r\n     /* 모달 창을 왼쪽으로 위치 */\r\n    max-width: 80%; /* 모달 창의 최대 가로 너비를 100%로 설정 */\r\n    width: 100%; /* 모달 창의 가로 너비를 100%로 설정 */\r\n}\r\n\r\n</style>\r\n\r\n\r\n\r\n\r\n\r\n"]}]}